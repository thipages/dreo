var t="INUMBER",e="IOP1",n="IOP2",r="IOP3",s="IVAR",i="IVARNAME",o="IFUNCALL",a="IFUNDEF",h="IEXPR",u="IEXPREVAL",p="IMEMBER",c="IENDSTATEMENT",l="IARRAY";function f(t,e){this.type=t,this.value=null!=e?e:0}function d(t){return new f(e,t)}function v(t){return new f(n,t)}function x(t){return new f(r,t)}function y(o,a,u,c,d){for(var v,x,g,m,w=[],b=[],A=0;A<o.length;A++){var E=o[A],M=E.type;if(M===t||M===i)Array.isArray(E.value)?w.push.apply(w,y(E.value.map((function(e){return new f(t,e)})).concat(new f(l,E.value.length)),a,u,c,d)):w.push(E);else if(M===s&&d.hasOwnProperty(E.value))E=new f(t,d[E.value]),w.push(E);else if(M===n&&w.length>1)x=w.pop(),v=w.pop(),m=u[E.value],E=new f(t,m(v.value,x.value)),w.push(E);else if(M===r&&w.length>2)g=w.pop(),x=w.pop(),v=w.pop(),"?"===E.value?w.push(v.value?x.value:g.value):(m=c[E.value],E=new f(t,m(v.value,x.value,g.value)),w.push(E));else if(M===e&&w.length>0)v=w.pop(),m=a[E.value],E=new f(t,m(v.value)),w.push(E);else if(M===h){for(;w.length>0;)b.push(w.shift());b.push(new f(h,y(E.value,a,u,c,d)))}else if(M===p&&w.length>0)v=w.pop(),w.push(new f(t,v.value[E.value]));else{for(;w.length>0;)b.push(w.shift());b.push(E)}}for(;w.length>0;)b.push(w.shift());return b}function g(t,i,o){for(var a=[],u=0;u<t.length;u++){var p=t[u],c=p.type;if(c===s&&p.value===i)for(var l=0;l<o.tokens.length;l++){var y,m=o.tokens[l];y=m.type===e?d(m.value):m.type===n?v(m.value):m.type===r?x(m.value):new f(m.type,m.value),a.push(y)}else c===h?a.push(new f(h,g(p.value,i,o))):a.push(p)}return a}function m(f,d,v){var x,y,g,E,M,k,O=[];if(b(f))return A(f,v);for(var T=f.length,C=0;C<T;C++){var N=f[C],S=N.type;if(S===t||S===i)O.push(N.value);else if(S===n)y=O.pop(),x=O.pop(),"and"===N.value?O.push(!!x&&!!m(y,d,v)):"or"===N.value?O.push(!!x||!!m(y,d,v)):"="===N.value?(E=d.binaryOps[N.value],O.push(E(x,m(y,d,v),v))):(E=d.binaryOps[N.value],O.push(E(A(x,v),A(y,v))));else if(S===r)g=O.pop(),y=O.pop(),x=O.pop(),"?"===N.value?O.push(m(x?y:g,d,v)):(E=d.ternaryOps[N.value],O.push(E(A(x,v),A(y,v),A(g,v))));else if(S===s)if(N.value in d.functions)O.push(d.functions[N.value]);else if(N.value in d.unaryOps&&d.parser.isOperatorEnabled(N.value))O.push(d.unaryOps[N.value]);else{var $=v[N.value];if(void 0===$)throw new Error("undefined variable: "+N.value);O.push($)}else if(S===e)x=O.pop(),E=d.unaryOps[N.value],O.push(E(A(x,v)));else if(S===o){for(k=N.value,M=[];k-- >0;)M.unshift(A(O.pop(),v));if(!(E=O.pop()).apply||!E.call)throw new Error(E+" is not a function");O.push(E.apply(void 0,M))}else if(S===a)O.push(function(){for(var t=O.pop(),e=[],n=N.value;n-- >0;)e.unshift(O.pop());var r=O.pop(),s=function(){for(var n=Object.assign({},v),r=0,s=e.length;r<s;r++)n[e[r]]=arguments[r];return m(t,d,n)};return Object.defineProperty(s,"name",{value:r,writable:!1}),v[r]=s,s}());else if(S===h)O.push(w(N,d));else if(S===u)O.push(N);else if(S===p)x=O.pop(),O.push(x[N.value]);else if(S===c)O.pop();else{if(S!==l)throw new Error("invalid Expression");for(k=N.value,M=[];k-- >0;)M.unshift(O.pop());O.push(M)}}if(O.length>1)throw new Error("invalid Expression (parity)");return 0===O[0]?0:A(O[0],v)}function w(t,e,n){return b(t)?t:{type:u,value:function(n){return m(t.value,e,n)}}}function b(t){return t&&t.type===u}function A(t,e){return b(t)?t.value(e):t}function E(u,f){for(var d,v,x,y,g,m,w=[],b=0;b<u.length;b++){var A=u[b],k=A.type;if(k===t)"number"==typeof A.value&&A.value<0?w.push("("+A.value+")"):Array.isArray(A.value)?w.push("["+A.value.map(M).join(", ")+"]"):w.push(M(A.value));else if(k===n)v=w.pop(),d=w.pop(),y=A.value,f?"^"===y?w.push("Math.pow("+d+", "+v+")"):"and"===y?w.push("(!!"+d+" && !!"+v+")"):"or"===y?w.push("(!!"+d+" || !!"+v+")"):"||"===y?w.push("(function(a,b){ return Array.isArray(a) && Array.isArray(b) ? a.concat(b) : String(a) + String(b); }(("+d+"),("+v+")))"):"=="===y?w.push("("+d+" === "+v+")"):"!="===y?w.push("("+d+" !== "+v+")"):"["===y?w.push(d+"[("+v+") | 0]"):w.push("("+d+" "+y+" "+v+")"):"["===y?w.push(d+"["+v+"]"):w.push("("+d+" "+y+" "+v+")");else if(k===r){if(x=w.pop(),v=w.pop(),d=w.pop(),"?"!==(y=A.value))throw new Error("invalid Expression");w.push("("+d+" ? "+v+" : "+x+")")}else if(k===s||k===i)w.push(A.value);else if(k===e)d=w.pop(),"-"===(y=A.value)||"+"===y?w.push("("+y+d+")"):f?"not"===y?w.push("(!"+d+")"):"!"===y?w.push("fac("+d+")"):w.push(y+"("+d+")"):"!"===y?w.push("("+d+"!)"):w.push("("+y+" "+d+")");else if(k===o){for(m=A.value,g=[];m-- >0;)g.unshift(w.pop());y=w.pop(),w.push(y+"("+g.join(", ")+")")}else if(k===a){for(v=w.pop(),m=A.value,g=[];m-- >0;)g.unshift(w.pop());d=w.pop(),f?w.push("("+d+" = function("+g.join(", ")+") { return "+v+" })"):w.push("("+d+"("+g.join(", ")+") = "+v+")")}else if(k===p)d=w.pop(),w.push(d+"."+A.value);else if(k===l){for(m=A.value,g=[];m-- >0;)g.unshift(w.pop());w.push("["+g.join(", ")+"]")}else if(k===h)w.push("("+E(A.value,f)+")");else if(k!==c)throw new Error("invalid Expression")}return w.length>1&&(w=f?[w.join(",")]:[w.join(";")]),String(w[0])}function M(t){return"string"==typeof t?JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"):t}function k(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return!0;return!1}function O(t,e,n){for(var r=!!(n=n||{}).withMembers,o=null,a=0;a<t.length;a++){var u=t[a];u.type===s||u.type===i?r||k(e,u.value)?null!==o?(k(e,o)||e.push(o),o=u.value):o=u.value:e.push(u.value):u.type===p&&r&&null!==o?o+="."+u.value:u.type===h?O(u.value,e,n):null!==o&&(k(e,o)||e.push(o),o=null)}null===o||k(e,o)||e.push(o)}function T(t,e){this.tokens=t,this.parser=e,this.unaryOps=e.unaryOps,this.binaryOps=e.binaryOps,this.ternaryOps=e.ternaryOps,this.functions=e.functions}f.prototype.toString=function(){switch(this.type){case t:case e:case n:case r:case s:case i:case c:return this.value;case o:return"CALL "+this.value;case a:return"DEF "+this.value;case l:return"ARRAY "+this.value;case p:return"."+this.value;default:return"Invalid Instruction"}},T.prototype.simplify=function(t){return t=t||{},new T(y(this.tokens,this.unaryOps,this.binaryOps,this.ternaryOps,t),this.parser)},T.prototype.substitute=function(t,e){return e instanceof T||(e=this.parser.parse(String(e))),new T(g(this.tokens,t,e),this.parser)},T.prototype.evaluate=function(t){return t=t||{},m(this.tokens,this,t)},T.prototype.toString=function(){return E(this.tokens,!1)},T.prototype.symbols=function(t){t=t||{};var e=[];return O(this.tokens,e,t),e},T.prototype.variables=function(t){t=t||{};var e=[];O(this.tokens,e,t);var n=this.functions;return e.filter((function(t){return!(t in n)}))},T.prototype.toJSFunction=function(t,e){var n=this,r=new Function(t,"with(this.functions) with (this.ternaryOps) with (this.binaryOps) with (this.unaryOps) { return "+E(this.simplify(e).tokens,!0)+"; }");return function(){return r.apply(n,arguments)}};var C="TEOF",N="TOP",S="TNUMBER",$="TSTRING",I="TPAREN",P="TBRACKET",R="TCOMMA",F="TNAME",L="TSEMICOLON";function j(t,e,n){this.type=t,this.value=e,this.index=n}function q(t,e){this.pos=0,this.current=null,this.unaryOps=t.unaryOps,this.binaryOps=t.binaryOps,this.ternaryOps=t.ternaryOps,this.consts=t.consts,this.expression=e,this.savedPosition=0,this.savedCurrent=null,this.options=t.options,this.parser=t}j.prototype.toString=function(){return this.type+": "+this.value},q.prototype.newToken=function(t,e,n){return new j(t,e,null!=n?n:this.pos)},q.prototype.save=function(){this.savedPosition=this.pos,this.savedCurrent=this.current},q.prototype.restore=function(){this.pos=this.savedPosition,this.current=this.savedCurrent},q.prototype.next=function(){return this.pos>=this.expression.length?this.newToken(C,"EOF"):this.isWhitespace()||this.isComment()?this.next():this.isRadixInteger()||this.isNumber()||this.isOperator()||this.isString()||this.isParen()||this.isBracket()||this.isComma()||this.isSemicolon()||this.isNamedOp()||this.isConst()||this.isName()?this.current:void this.parseError('Unknown character "'+this.expression.charAt(this.pos)+'"')},q.prototype.isString=function(){var t=!1,e=this.pos,n=this.expression.charAt(e);if("'"===n||'"'===n)for(var r=this.expression.indexOf(n,e+1);r>=0&&this.pos<this.expression.length;){if(this.pos=r+1,"\\"!==this.expression.charAt(r-1)){var s=this.expression.substring(e+1,r);this.current=this.newToken($,this.unescape(s),e),t=!0;break}r=this.expression.indexOf(n,r+1)}return t},q.prototype.isParen=function(){var t=this.expression.charAt(this.pos);return("("===t||")"===t)&&(this.current=this.newToken(I,t),this.pos++,!0)},q.prototype.isBracket=function(){var t=this.expression.charAt(this.pos);return!("["!==t&&"]"!==t||!this.isOperatorEnabled("["))&&(this.current=this.newToken(P,t),this.pos++,!0)},q.prototype.isComma=function(){return","===this.expression.charAt(this.pos)&&(this.current=this.newToken(R,","),this.pos++,!0)},q.prototype.isSemicolon=function(){return";"===this.expression.charAt(this.pos)&&(this.current=this.newToken(L,";"),this.pos++,!0)},q.prototype.isConst=function(){for(var t=this.pos,e=t;e<this.expression.length;e++){var n=this.expression.charAt(e);if(n.toUpperCase()===n.toLowerCase()&&(e===this.pos||"_"!==n&&"."!==n&&(n<"0"||n>"9")))break}if(e>t){var r=this.expression.substring(t,e);if(r in this.consts)return this.current=this.newToken(S,this.consts[r]),this.pos+=r.length,!0}return!1},q.prototype.isNamedOp=function(){for(var t=this.pos,e=t;e<this.expression.length;e++){var n=this.expression.charAt(e);if(n.toUpperCase()===n.toLowerCase()&&(e===this.pos||"_"!==n&&(n<"0"||n>"9")))break}if(e>t){var r=this.expression.substring(t,e);if(this.isOperatorEnabled(r)&&(r in this.binaryOps||r in this.unaryOps||r in this.ternaryOps))return this.current=this.newToken(N,r),this.pos+=r.length,!0}return!1},q.prototype.isName=function(){for(var t=this.pos,e=t,n=!1;e<this.expression.length;e++){var r=this.expression.charAt(e);if(r.toUpperCase()===r.toLowerCase()){if(e===this.pos&&("$"===r||"_"===r)){"_"===r&&(n=!0);continue}if(e===this.pos||!n||"_"!==r&&(r<"0"||r>"9"))break}else n=!0}if(n){var s=this.expression.substring(t,e);return this.current=this.newToken(F,s),this.pos+=s.length,!0}return!1},q.prototype.isWhitespace=function(){for(var t=!1,e=this.expression.charAt(this.pos);!(" "!==e&&"\t"!==e&&"\n"!==e&&"\r"!==e||(t=!0,this.pos++,this.pos>=this.expression.length));)e=this.expression.charAt(this.pos);return t};var B=/^[0-9a-f]{4}$/i;function W(t,e,n){this.parser=t,this.tokens=e,this.current=null,this.nextToken=null,this.next(),this.savedCurrent=null,this.savedNextToken=null,this.allowMemberAccess=!1!==n.allowMemberAccess}q.prototype.unescape=function(t){var e=t.indexOf("\\");if(e<0)return t;for(var n=t.substring(0,e);e>=0;){var r=t.charAt(++e);switch(r){case"'":n+="'";break;case'"':n+='"';break;case"\\":n+="\\";break;case"/":n+="/";break;case"b":n+="\b";break;case"f":n+="\f";break;case"n":n+="\n";break;case"r":n+="\r";break;case"t":n+="\t";break;case"u":var s=t.substring(e+1,e+5);B.test(s)||this.parseError("Illegal escape sequence: \\u"+s),n+=String.fromCharCode(parseInt(s,16)),e+=4;break;default:throw this.parseError('Illegal escape sequence: "\\'+r+'"')}++e;var i=t.indexOf("\\",e);n+=t.substring(e,i<0?t.length:i),e=i}return n},q.prototype.isComment=function(){return"/"===this.expression.charAt(this.pos)&&"*"===this.expression.charAt(this.pos+1)&&(this.pos=this.expression.indexOf("*/",this.pos)+2,1===this.pos&&(this.pos=this.expression.length),!0)},q.prototype.isRadixInteger=function(){var t,e,n=this.pos;if(n>=this.expression.length-2||"0"!==this.expression.charAt(n))return!1;if(++n,"x"===this.expression.charAt(n))t=16,e=/^[0-9a-f]$/i,++n;else{if("b"!==this.expression.charAt(n))return!1;t=2,e=/^[01]$/i,++n}for(var r=!1,s=n;n<this.expression.length;){var i=this.expression.charAt(n);if(!e.test(i))break;n++,r=!0}return r&&(this.current=this.newToken(S,parseInt(this.expression.substring(s,n),t)),this.pos=n),r},q.prototype.isNumber=function(){for(var t,e=!1,n=this.pos,r=n,s=n,i=!1,o=!1;n<this.expression.length&&((t=this.expression.charAt(n))>="0"&&t<="9"||!i&&"."===t);)"."===t?i=!0:o=!0,n++,e=o;if(e&&(s=n),"e"===t||"E"===t){n++;for(var a=!0,h=!1;n<this.expression.length;){if(t=this.expression.charAt(n),!a||"+"!==t&&"-"!==t){if(!(t>="0"&&t<="9"))break;h=!0,a=!1}else a=!1;n++}h||(n=s)}return e?(this.current=this.newToken(S,parseFloat(this.expression.substring(r,n))),this.pos=n):this.pos=s,e},q.prototype.isOperator=function(){var t=this.pos,e=this.expression.charAt(this.pos);if("+"===e||"-"===e||"*"===e||"/"===e||"%"===e||"^"===e||"?"===e||":"===e||"."===e)this.current=this.newToken(N,e);else if("∙"===e||"•"===e)this.current=this.newToken(N,"*");else if(">"===e)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(N,">="),this.pos++):this.current=this.newToken(N,">");else if("<"===e)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(N,"<="),this.pos++):this.current=this.newToken(N,"<");else if("|"===e){if("|"!==this.expression.charAt(this.pos+1))return!1;this.current=this.newToken(N,"||"),this.pos++}else if("="===e)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(N,"=="),this.pos++):this.current=this.newToken(N,e);else{if("!"!==e)return!1;"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(N,"!="),this.pos++):this.current=this.newToken(N,e)}return this.pos++,!!this.isOperatorEnabled(this.current.value)||(this.pos=t,!1)},q.prototype.isOperatorEnabled=function(t){return this.parser.isOperatorEnabled(t)},q.prototype.getCoordinates=function(){var t,e=0,n=-1;do{e++,t=this.pos-n,n=this.expression.indexOf("\n",n+1)}while(n>=0&&n<this.pos);return{line:e,column:t}},q.prototype.parseError=function(t){var e=this.getCoordinates();throw new Error("parse error ["+e.line+":"+e.column+"]: "+t)},W.prototype.next=function(){return this.current=this.nextToken,this.nextToken=this.tokens.next()},W.prototype.tokenMatches=function(t,e){return void 0===e||(Array.isArray(e)?k(e,t.value):"function"==typeof e?e(t):t.value===e)},W.prototype.save=function(){this.savedCurrent=this.current,this.savedNextToken=this.nextToken,this.tokens.save()},W.prototype.restore=function(){this.tokens.restore(),this.current=this.savedCurrent,this.nextToken=this.savedNextToken},W.prototype.accept=function(t,e){return!(this.nextToken.type!==t||!this.tokenMatches(this.nextToken,e))&&(this.next(),!0)},W.prototype.expect=function(t,e){if(!this.accept(t,e)){var n=this.tokens.getCoordinates();throw new Error("parse error ["+n.line+":"+n.column+"]: Expected "+(e||t))}},W.prototype.parseAtom=function(e){var n=this.tokens.unaryOps;if(this.accept(F)||this.accept(N,(function(t){return t.value in n})))e.push(new f(s,this.current.value));else if(this.accept(S))e.push(new f(t,this.current.value));else if(this.accept($))e.push(new f(t,this.current.value));else if(this.accept(I,"("))this.parseExpression(e),this.expect(I,")");else{if(!this.accept(P,"["))throw new Error("unexpected "+this.nextToken);if(this.accept(P,"]"))e.push(new f(l,0));else{var r=this.parseArrayList(e);e.push(new f(l,r))}}},W.prototype.parseExpression=function(t){var e=[];this.parseUntilEndStatement(t,e)||(this.parseVariableAssignmentExpression(e),this.parseUntilEndStatement(t,e)||this.pushExpression(t,e))},W.prototype.pushExpression=function(t,e){for(var n=0,r=e.length;n<r;n++)t.push(e[n])},W.prototype.parseUntilEndStatement=function(t,e){return!!this.accept(L)&&(!this.nextToken||this.nextToken.type===C||this.nextToken.type===I&&")"===this.nextToken.value||e.push(new f(c)),this.nextToken.type!==C&&this.parseExpression(e),t.push(new f(h,e)),!0)},W.prototype.parseArrayList=function(t){for(var e=0;!this.accept(P,"]");)for(this.parseExpression(t),++e;this.accept(R);)this.parseExpression(t),++e;return e},W.prototype.parseVariableAssignmentExpression=function(t){for(this.parseConditionalExpression(t);this.accept(N,"=");){var e=t.pop(),n=[],r=t.length-1;if(e.type!==o){if(e.type!==s&&e.type!==p)throw new Error("expected variable for assignment");this.parseVariableAssignmentExpression(n),t.push(new f(i,e.value)),t.push(new f(h,n)),t.push(v("="))}else{if(!this.tokens.isOperatorEnabled("()="))throw new Error("function definition is not permitted");for(var u=0,c=e.value+1;u<c;u++){var l=r-u;t[l].type===s&&(t[l]=new f(i,t[l].value))}this.parseVariableAssignmentExpression(n),t.push(new f(h,n)),t.push(new f(a,e.value))}}},W.prototype.parseConditionalExpression=function(t){for(this.parseOrExpression(t);this.accept(N,"?");){var e=[],n=[];this.parseConditionalExpression(e),this.expect(N,":"),this.parseConditionalExpression(n),t.push(new f(h,e)),t.push(new f(h,n)),t.push(x("?"))}},W.prototype.parseOrExpression=function(t){for(this.parseAndExpression(t);this.accept(N,"or");){var e=[];this.parseAndExpression(e),t.push(new f(h,e)),t.push(v("or"))}},W.prototype.parseAndExpression=function(t){for(this.parseComparison(t);this.accept(N,"and");){var e=[];this.parseComparison(e),t.push(new f(h,e)),t.push(v("and"))}};var D=["==","!=","<","<=",">=",">","in"];W.prototype.parseComparison=function(t){for(this.parseAddSub(t);this.accept(N,D);){var e=this.current;this.parseAddSub(t),t.push(v(e.value))}};var U=["+","-","||"];W.prototype.parseAddSub=function(t){for(this.parseTerm(t);this.accept(N,U);){var e=this.current;this.parseTerm(t),t.push(v(e.value))}};var _=["*","/","%"];function V(t,e){return Number(t)+Number(e)}function J(t,e){return t-e}function z(t,e){return t*e}function G(t,e){return t/e}function X(t,e){return t%e}function Y(t,e){return Array.isArray(t)&&Array.isArray(e)?t.concat(e):""+t+e}function Z(t,e){return t===e}function H(t,e){return t!==e}function K(t,e){return t>e}function Q(t,e){return t<e}function tt(t,e){return t>=e}function et(t,e){return t<=e}function nt(t,e){return Boolean(t&&e)}function rt(t,e){return Boolean(t||e)}function st(t,e){return k(e,t)}function it(t){return(Math.exp(t)-Math.exp(-t))/2}function ot(t){return(Math.exp(t)+Math.exp(-t))/2}function at(t){return t===1/0?1:t===-1/0?-1:(Math.exp(t)-Math.exp(-t))/(Math.exp(t)+Math.exp(-t))}function ht(t){return t===-1/0?t:Math.log(t+Math.sqrt(t*t+1))}function ut(t){return Math.log(t+Math.sqrt(t*t-1))}function pt(t){return Math.log((1+t)/(1-t))/2}function ct(t){return Math.log(t)*Math.LOG10E}function lt(t){return-t}function ft(t){return!t}function dt(t){return t<0?Math.ceil(t):Math.floor(t)}function vt(t){return Math.random()*(t||1)}function xt(t){return mt(t+1)}W.prototype.parseTerm=function(t){for(this.parseFactor(t);this.accept(N,_);){var e=this.current;this.parseFactor(t),t.push(v(e.value))}},W.prototype.parseFactor=function(t){var e=this.tokens.unaryOps;if(this.save(),this.accept(N,(function(t){return t.value in e}))){if("-"!==this.current.value&&"+"!==this.current.value){if(this.nextToken.type===I&&"("===this.nextToken.value)return this.restore(),void this.parseExponential(t);if(this.nextToken.type===L||this.nextToken.type===R||this.nextToken.type===C||this.nextToken.type===I&&")"===this.nextToken.value)return this.restore(),void this.parseAtom(t)}var n=this.current;this.parseFactor(t),t.push(d(n.value))}else this.parseExponential(t)},W.prototype.parseExponential=function(t){for(this.parsePostfixExpression(t);this.accept(N,"^");)this.parseFactor(t),t.push(v("^"))},W.prototype.parsePostfixExpression=function(t){for(this.parseFunctionCall(t);this.accept(N,"!");)t.push(d("!"))},W.prototype.parseFunctionCall=function(t){var e=this.tokens.unaryOps;if(this.accept(N,(function(t){return t.value in e}))){var n=this.current;this.parseAtom(t),t.push(d(n.value))}else for(this.parseMemberExpression(t);this.accept(I,"(");)if(this.accept(I,")"))t.push(new f(o,0));else{var r=this.parseArgumentList(t);t.push(new f(o,r))}},W.prototype.parseArgumentList=function(t){for(var e=0;!this.accept(I,")");)for(this.parseExpression(t),++e;this.accept(R);)this.parseExpression(t),++e;return e},W.prototype.parseMemberExpression=function(t){for(this.parseAtom(t);this.accept(N,".")||this.accept(P,"[");){var e=this.current;if("."===e.value){if(!this.allowMemberAccess)throw new Error('unexpected ".", member access is not permitted');this.expect(F),t.push(new f(p,this.current.value))}else{if("["!==e.value)throw new Error("unexpected symbol: "+e.value);if(!this.tokens.isOperatorEnabled("["))throw new Error('unexpected "[]", arrays are disabled');this.parseExpression(t),this.expect(P,"]"),t.push(v("["))}}};var yt=4.7421875,gt=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];function mt(t){var e,n;if(function(t){return isFinite(t)&&t===Math.round(t)}(t)){if(t<=0)return isFinite(t)?1/0:NaN;if(t>171)return 1/0;for(var r=t-2,s=t-1;r>1;)s*=r,r--;return 0===s&&(s=1),s}if(t<.5)return Math.PI/(Math.sin(Math.PI*t)*mt(1-t));if(t>=171.35)return 1/0;if(t>85){var i=t*t,o=i*t,a=o*t,h=a*t;return Math.sqrt(2*Math.PI/t)*Math.pow(t/Math.E,t)*(1+1/(12*t)+1/(288*i)-139/(51840*o)-571/(2488320*a)+163879/(209018880*h)+5246819/(75246796800*h*t))}--t,n=gt[0];for(var u=1;u<gt.length;++u)n+=gt[u]/(t+u);return e=t+yt+.5,Math.sqrt(2*Math.PI)*Math.pow(e,t+.5)*Math.exp(-e)*n}function wt(t){return Array.isArray(t)?t.length:String(t).length}function bt(){for(var t=0,e=0,n=0;n<arguments.length;n++){var r,s=Math.abs(arguments[n]);e<s?(t=t*(r=e/s)*r+1,e=s):t+=s>0?(r=s/e)*r:s}return e===1/0?1/0:e*Math.sqrt(t)}function At(t,e,n){return t?e:n}function Et(t,e){return void 0===e||0==+e?Math.round(t):(t=+t,e=-+e,isNaN(t)||"number"!=typeof e||e%1!=0?NaN:(t=t.toString().split("e"),+((t=(t=Math.round(+(t[0]+"e"+(t[1]?+t[1]-e:-e)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+e:e))))}function Mt(t,e,n){return n&&(n[t]=e),e}function kt(t,e){return t[0|e]}function Ot(t){return 1===arguments.length&&Array.isArray(t)?Math.max.apply(Math,t):Math.max.apply(Math,arguments)}function Tt(t){return 1===arguments.length&&Array.isArray(t)?Math.min.apply(Math,t):Math.min.apply(Math,arguments)}function Ct(t,e){if("function"!=typeof t)throw new Error("First argument to map is not a function");if(!Array.isArray(e))throw new Error("Second argument to map is not an array");return e.map((function(e,n){return t(e,n)}))}function Nt(t,e,n){if("function"!=typeof t)throw new Error("First argument to fold is not a function");if(!Array.isArray(n))throw new Error("Second argument to fold is not an array");return n.reduce((function(e,n,r){return t(e,n,r)}),e)}function St(t,e){if("function"!=typeof t)throw new Error("First argument to filter is not a function");if(!Array.isArray(e))throw new Error("Second argument to filter is not an array");return e.filter((function(e,n){return t(e,n)}))}function $t(t,e){if(!Array.isArray(e)&&"string"!=typeof e)throw new Error("Second argument to indexOf is not a string or array");return e.indexOf(t)}function It(t,e){if(!Array.isArray(e))throw new Error("Second argument to join is not an array");return e.join(t)}function Pt(t){return(t>0)-(t<0)||+t}var Rt=1/3;function Ft(t){return t<0?-Math.pow(-t,Rt):Math.pow(t,Rt)}function Lt(t){return Math.exp(t)-1}function jt(t){return Math.log(1+t)}function qt(t){return Math.log(t)/Math.LN2}function Bt(t){this.options=t||{},this.unaryOps={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:Math.sinh||it,cosh:Math.cosh||ot,tanh:Math.tanh||at,asinh:Math.asinh||ht,acosh:Math.acosh||ut,atanh:Math.atanh||pt,sqrt:Math.sqrt,cbrt:Math.cbrt||Ft,log:Math.log,log2:Math.log2||qt,ln:Math.log,lg:Math.log10||ct,log10:Math.log10||ct,expm1:Math.expm1||Lt,log1p:Math.log1p||jt,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:Math.trunc||dt,"-":lt,"+":Number,exp:Math.exp,not:ft,length:wt,"!":xt,sign:Math.sign||Pt},this.binaryOps={"+":V,"-":J,"*":z,"/":G,"%":X,"^":Math.pow,"||":Y,"==":Z,"!=":H,">":K,"<":Q,">=":tt,"<=":et,and:nt,or:rt,in:st,"=":Mt,"[":kt},this.ternaryOps={"?":At},this.functions={random:vt,fac:xt,min:Tt,max:Ot,hypot:Math.hypot||bt,pyt:Math.hypot||bt,pow:Math.pow,atan2:Math.atan2,if:At,gamma:mt,roundTo:Et,map:Ct,fold:Nt,filter:St,indexOf:$t,join:It},this.consts={E:Math.E,PI:Math.PI,true:!0,false:!1}}Bt.prototype.parse=function(t){var e=[],n=new W(this,new q(this,t),{allowMemberAccess:this.options.allowMemberAccess});return n.parseExpression(e),n.expect(C,"EOF"),new T(e,this)},Bt.prototype.evaluate=function(t,e){return this.parse(t).evaluate(e)};var Wt=new Bt;Bt.parse=function(t){return Wt.parse(t)},Bt.evaluate=function(t,e){return Wt.parse(t).evaluate(e)};var Dt={"+":"add","-":"subtract","*":"multiply","/":"divide","%":"remainder","^":"power","!":"factorial","<":"comparison",">":"comparison","<=":"comparison",">=":"comparison","==":"comparison","!=":"comparison","||":"concatenate",and:"logical",or:"logical",not:"logical","?":"conditional",":":"conditional","=":"assignment","[":"array","()=":"fndef"};Bt.prototype.isOperatorEnabled=function(t){var e=function(t){return Dt.hasOwnProperty(t)?Dt[t]:t}(t),n=this.options.operators||{};return!(e in n)||!!n[e]};const Ut=new Bt,_t={a:{min:1,validate:[zt,zt]},t:{validate:zt},c:{validate:zt},r:{min:1,validate:[zt]},d:{validate:(Vt=["0","1"],function(t){return-1!==Vt.indexOf(t)})},z:{validate:[zt,zt]},f:{validate:[zt,zt,zt,zt]}};var Vt;const Jt=t=>Array.isArray(t)?t:[t];function zt(t){try{Ut.parse(t)}catch(t){throw"Error : expression can not be parsed"}return!0}function Gt(t){const e=[...t.matchAll(/^\s*(-*)\s*#(\w+)\s*=\s*(.+)\s*/g)];if(0===e.length)return!1;const[,n,r,s]=e[0];return"i"===r.charAt(0)&&Zt(index,"variable can not start with the letter i"),{dash:n,verb:"#",args:[r,s]}}function Xt(t,e){const n=Gt(t);if(n)return n;const r=Object.keys(_t).join("|"),s=new RegExp(`\\s*(-*)\\s*([${r}])\\s*(.+)`,"g"),i=[...t.matchAll(s)];0===i.length&&Zt(e,"unknown command");const[,o,a,h]=i[0],u=h.replace(/\s/g,"").split(",");return function(t,e){if(!_t[t])throw"ERROR: invalid";const n=Jt(_t[t].validate),r=_t[t].min,s=n.length-e.length;if(s<0)throw`Error : to many arguments for command ${t}`;if(e.length<r)throw`Error : Not enough arguments for command ${t}`;for(const[t,r]of n.entries()){if(!r(e[t]))throw"Error: invalid argument type";if(t===e.length-1)break}}(a,u),{dash:o,verb:a,args:u}}function Yt(t,e,n,r,s){const{dash:i,verb:o,args:a}=Xt(t,e),h=a,u=i.length,p=n.length;if("r"===o)Ht(e,o,h,p,u,n,r,s,!0);else{if("d"===o){const t="0"!==h[0];return{...s,drawing:t}}if("c"===o)return{...s,color:h[0]};Ht(e,o,h,p,u,n,r,s,!1)}return s}function Zt(t,e=""){throw`Error at line ${t+1} ${""===e?"":":"+e}`}function Ht(t,e,n,r,s,i,o,a,h){const u={verb:e,arg:n,children:[],...a};if(0===r)o.push(u),h&&i.push(u.children);else{const e=r-s;if(0===e){i[r-1].push(u),h&&i.push(u.children)}else e>0?function(t,e,n,r,s){for(let e=0;e<t;e++)n.pop();const i=0!==n.length?n[n.length-1]:null;null===i?(r.push(e),s&&n.push(e.children)):i.push(e)}(e,u,i,o,h):Zt(t,"mismatch on loops")}}const Kt={},Qt=new Bt;function te({layers:t,commands:e}){const{width:n,height:r}=t.getDimension(),s=t.getAll();return Kt.points=[{x:0,y:0}],Kt.angle=0,Kt.width=n,Kt.height=r,Kt.x=n/2,Kt.y=r/2,Kt.level=0,function(t,e,n){for(const n of e){const{verb:e,arg:r}=n;"f"===e||("r"===n.verb?re(t,n):(Kt.i=void 0,ne(t)(n)))}}(s,e,Kt.width),{clear(){te({layers:t,commands:[]})}}}function ee(t,e,n,r,s,i={x:0,y:0}){r?(t.strokeStyle=s,t.lineWidth=3,t.beginPath(),t.moveTo(e.x+Kt.x+i.x,e.y+Kt.y+i.y),t.lineTo(n.x+Kt.x+i.x,n.y+Kt.y+i.y),t.stroke()):t.moveTo(n.x+Kt.x,n.y+Kt.y)}function ne(t,e){return t[0].ctx.globalAlpha=.1,function(n){let r,s=n.arg.slice();"#"===n.verb&&(r=s.shift(),Kt[r]=Kt[r]||0);const i=s.map((t=>Qt.parse(t).evaluate(Kt)));switch(n.verb){case"a":1===i.length?function(t,e,n,r,s){const i=Kt.points[Kt.points.length-1],o=Math.cos(Kt.angle)*e,a=Math.sin(Kt.angle)*e,h={x:i.x+o,y:i.y+a};Kt.points.push(h),ee(t[0].ctx,i,h,n,r,s)}(t,i[0],n.drawing,n.color,e):function(t,[e,n],r,s,i){const o=Kt.points[Kt.points.length-1],a={x:e,y:n};Kt.points.push(a),ee(t[0].ctx,o,a,r,s,i)}(t,i,n.drawing,n.color,e);break;case"t":!function(t,e){Kt.angle-=(n=e,Math.PI*n/180),t[1];var n}(t,i[0]);break;case"z":Kt.x+=i[0],Kt.y+=i[1];break;case"#":Kt[r]=i[0]}}}function re(t,e){Kt.level++,function(t,e){let n,r,[s,i,o]=t;const a=i-s;null==o?(r=1,n={x:0,y:0}):(r=a/Kt.width,n={x:-Kt.width/2,y:0});void 0===i&&(i=s,s=0);for(let t=s;t<i;t+=r)Kt[se(Kt.level)]=t,e(n)}(e.arg,(n=>{for(const[r,s]of e.children.entries())"r"===s.verb?re(t,s):ne(t)(s,n)})),Kt.level--}function se(t){return Array(t).fill("").reduce(((t,e)=>t+="i"),"")}const ie=t=>Array(t).fill("").map(((t,e)=>e));"\nx!\tfactoriel de x\nabs x\tvaleur absolue de x\nacos x\tarc cosinus de x (en radians)\nacosh x\tcosinus hyperbolique réciproque de x (en radians)\nasin x\tArc sinus de x (en radians)\nasinh x\tsinus hyperbolique réciproque de x (en radians)\natan x\tarc tangente de x (en radians)\natanh x\ttangente hyperbolic réciproque (en radians)\ncbrt x\tracine cubique\ncos x\tcosinus de x (en radians)\ncosh x\tcosinus hyperbolique de x (en radians)\nexp x\texponentielle de x (ou e^x)\nln x\tlogarithme népérien de x (ou log x)\nlog10 x\tlogarithme de x en base 1\nlog2 x\tlogarithme de x en base 2\nnot x\topérateur logiue NOT\nsin x\tsinus de x (en radians)\nsinh x\tsinus hyperbolique de x (x is in radians)\nsqrt x\tracine carrée de x\ntan x\ttangente de x (en radians)\ntanh x\ttangente hyperbolique de x (en radians)\natan2(y, x)\tArc tangente de x/y. Angle entre (0, 0) and (x, y) en radians\n".split("\n").map((t=>t.split("\t"))).filter((t=>2===t.length)).map((t=>`<div class="bold small">${t[0]}</div><div class="small">${t[1]}</div>`)).join("");const oe="#L=1000\nr20\n-r36\n--a20\n--t10\n-t18\nd0\nr100\n-a228.6\n-d1\n-aL\n-a-L\n-d0\n-a-228.6\n-t3.6\n\nt-90\na400\nt90\n\na-35\nd1\nr36\n-a69.9\n-t10",ae="\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    top: 0;\n    left: 0;\n";const{isArray:he}=Array,{getPrototypeOf:ue,getOwnPropertyDescriptor:pe}=Object,ce=[],le=()=>document.createRange(),fe=(t,e,n)=>(t.set(e,n),n),{setPrototypeOf:de}=Object;let ve;var xe=(t,e,n)=>(ve||(ve=le()),n?ve.setStartAfter(t):ve.setStartBefore(t),ve.setEndAfter(e),ve.deleteContents(),t);const ye=({firstChild:t,lastChild:e},n)=>xe(t,e,n);let ge=!1;const me=(t,e)=>ge&&11===t.nodeType?1/e<0?e?ye(t,!0):t.lastChild:e?t.valueOf():t.firstChild:t,we=t=>document.createComment(t);class be extends((t=>{function e(t){return de(t,new.target.prototype)}return e.prototype=t.prototype,e})(DocumentFragment)){#t=we("<>");#e=we("</>");#n=ce;constructor(t){super(t),this.replaceChildren(this.#t,...t.childNodes,this.#e),ge=!0}get firstChild(){return this.#t}get lastChild(){return this.#e}get parentNode(){return this.#t.parentNode}remove(){ye(this,!1)}replaceWith(t){ye(this,!0).replaceWith(t)}valueOf(){let{firstChild:t,lastChild:e,parentNode:n}=this;if(n===this)this.#n===ce&&(this.#n=[...this.childNodes]);else{if(n)for(this.#n=[t];t!==e;)this.#n.push(t=t.nextSibling);this.replaceChildren(...this.#n)}return this}}const Ae=(t,e,n)=>t.setAttribute(e,n),Ee=(t,e)=>t.removeAttribute(e);let Me;const ke=(t,e,n)=>{n=n.slice(1),Me||(Me=new WeakMap);const r=Me.get(t)||fe(Me,t,{});let s=r[n];return s&&s[0]&&t.removeEventListener(n,...s),s=he(e)?e:[e,!1],r[n]=s,s[0]&&t.addEventListener(n,...s),e},Oe=(t,e)=>{const{t:n,n:r}=t;let s=!1;switch(typeof e){case"object":if(null!==e){(r||n).replaceWith(t.n=e.valueOf());break}case"undefined":s=!0;default:n.data=s?"":e,r&&(t.n=null,r.replaceWith(n))}return e},Te=(t,e,n)=>t[n]=e,Ce=(t,e,n)=>Te(t,e,n.slice(1)),Ne=(t,e,n)=>null==e?(Ee(t,n),e):Te(t,e,n),Se=(t,e)=>("function"==typeof e?e(t):e.current=t,e),$e=(t,e,n)=>(null==e?Ee(t,n):Ae(t,n,e),e),Ie=(t,e,n)=>(t.toggleAttribute(n.slice(1),e),e),Pe=(t,e,n)=>{const{length:r}=e;if(t.data=`[${r}]`,r)return((t,e,n,r,s)=>{const i=n.length;let o=e.length,a=i,h=0,u=0,p=null;for(;h<o||u<a;)if(o===h){const e=a<i?u?r(n[u-1],-0).nextSibling:r(n[a-u],0):s;for(;u<a;)t.insertBefore(r(n[u++],1),e)}else if(a===u)for(;h<o;)p&&p.has(e[h])||t.removeChild(r(e[h],-1)),h++;else if(e[h]===n[u])h++,u++;else if(e[o-1]===n[a-1])o--,a--;else if(e[h]===n[a-1]&&n[u]===e[o-1]){const s=r(e[--o],-1).nextSibling;t.insertBefore(r(n[u++],1),r(e[h++],-1).nextSibling),t.insertBefore(r(n[--a],1),s),e[o]=n[a]}else{if(!p){p=new Map;let t=u;for(;t<a;)p.set(n[t],t++)}if(p.has(e[h])){const s=p.get(e[h]);if(u<s&&s<a){let i=h,c=1;for(;++i<o&&i<a&&p.get(e[i])===s+c;)c++;if(c>s-u){const i=r(e[h],0);for(;u<s;)t.insertBefore(r(n[u++],1),i)}else t.replaceChild(r(n[u++],1),r(e[h++],-1))}else h++}else t.removeChild(r(e[h++],-1))}return n})(t.parentNode,n,e,me,t);switch(n.length){case 1:n[0].remove();case 0:break;default:xe(me(n[0],0),me(n.at(-1),-0),!1)}return ce},Re=new Map([["aria",(t,e)=>{for(const n in e){const r=e[n],s="role"===n?n:`aria-${n}`;null==r?Ee(t,s):Ae(t,s,r)}return e}],["class",(t,e)=>Ne(t,e,null==e?"class":"className")],["data",(t,e)=>{const{dataset:n}=t;for(const t in e)null==e[t]?delete n[t]:n[t]=e[t];return e}],["ref",Se],["style",(t,e)=>null==e?Ne(t,e,"style"):Te(t.style,e,"cssText")]]),Fe=(t,e,n)=>{switch(e[0]){case".":return Ce;case"?":return Ie;case"@":return ke;default:return n||"ownerSVGElement"in t?"ref"===e?Se:$e:Re.get(e)||(e in t?e.startsWith("on")?Te:((t,e)=>{let n;do{n=pe(t,e)}while(!n&&(t=ue(t)));return n})(t,e)?.set?Ne:$e:$e)}},Le=(t,e)=>(t.textContent=null==e?"":e,e),je=(t,e,n)=>({a:t,b:e,c:n}),qe=()=>je(null,null,ce),Be=(t,e)=>e.reduceRight(We,t),We=(t,e)=>t.childNodes[e];var De=t=>(e,n)=>{const{a:r,b:s,c:i}=t(e,n),o=document.importNode(r,!0);let a=ce;if(s!==ce){a=[];for(let t,e,n=0;n<s.length;n++){const{a:r,b:i,c:l}=s[n],f=r===e?t:t=Be(o,e=r);a[n]=(h=i,u=f,p=l,c=i===Pe?[]:i===Oe?qe():null,{v:ce,u:h,t:u,n:p,c:c})}}var h,u,p,c;return((t,e)=>({b:t,c:e}))(i?o.firstChild:new be(o),a)};const Ue=/^(?:plaintext|script|style|textarea|title|xmp)$/i,_e=/^(?:area|base|br|col|embed|hr|img|input|keygen|link|menuitem|meta|param|source|track|wbr)$/i,Ve=/<([a-zA-Z0-9]+[a-zA-Z0-9:._-]*)([^>]*?)(\/?)>/g,Je=/([^\s\\>"'=]+)\s*=\s*(['"]?)\x01/g,ze=/[\x01\x02]/g;let Ge,Xe,Ye=document.createElement("template");var Ze=(t,e)=>{if(e)return Ge||(Ge=document.createElementNS("http://www.w3.org/2000/svg","svg"),Xe=le(),Xe.selectNodeContents(Ge)),Xe.createContextualFragment(t);Ye.innerHTML=t;const{content:n}=Ye;return Ye=Ye.cloneNode(!1),n};const He=t=>{const e=[];let n;for(;n=t.parentNode;)e.push(e.indexOf.call(n.childNodes,t)),t=n;return e},Ke=()=>document.createTextNode(""),Qe=(t,e,n)=>{const r=Ze(((t,e,n)=>{let r=0;return t.join("").trim().replace(Ve,((t,e,r,s)=>`<${e}${r.replace(Je,"=$2$1").trimEnd()}${s?n||_e.test(e)?" /":`></${e}`:""}>`)).replace(ze,(t=>""===t?`\x3c!--${e+r++}--\x3e`:e+r++))})(t,en,n),n),{length:s}=t;let i=ce;if(s>1){const t=[],o=document.createTreeWalker(r,129);let a=0,h=`${en}${a++}`;for(i=[];a<s;){const r=o.nextNode();if(8===r.nodeType){if(r.data===h){const n=he(e[a-1])?Pe:Oe;n===Oe&&t.push(r),i.push(je(He(r),n,null)),h=`${en}${a++}`}}else{let t;for(;r.hasAttribute(h);){t||(t=He(r));const e=r.getAttribute(h);i.push(je(t,Fe(r,e,n),e)),Ee(r,h),h=`${en}${a++}`}!n&&Ue.test(r.localName)&&r.textContent.trim()===`\x3c!--${h}--\x3e`&&(i.push(je(t||He(r),Le,null)),h=`${en}${a++}`)}}for(a=0;a<t.length;a++)t[a].replaceWith(Ke())}const{childNodes:o}=r;let{length:a}=o;return a<1?(a=1,r.appendChild(Ke())):1===a&&1!==s&&1!==o[0].nodeType&&(a=0),fe(tn,t,je(r,i,1===a))},tn=new WeakMap,en="isµ";var nn=t=>(e,n)=>tn.get(e)||Qe(e,n,t);const rn=De(nn(!1)),sn=De(nn(!0)),on=(t,{s:e,t:n,v:r})=>{if(t.a!==n){const{b:s,c:i}=(e?sn:rn)(n,r);t.a=n,t.b=s,t.c=i}for(let{c:e}=t,n=0;n<e.length;n++){const t=r[n],s=e[n];switch(s.u){case Pe:s.v=Pe(s.t,an(s.c,t),s.v);break;case Oe:const e=t instanceof hn?on(s.c||(s.c=qe()),t):(s.c=null,t);e!==s.v&&(s.v=Oe(s,e));break;default:t!==s.v&&(s.v=s.u(s.t,t,s.n,s.v))}}return t.b},an=(t,e)=>{let n=0,{length:r}=e;for(r<t.length&&t.splice(r);n<r;n++){const r=e[n];r instanceof hn?e[n]=on(t[n]||(t[n]=qe()),r):t[n]=null}return e};class hn{constructor(t,e,n){this.s=t,this.t=e,this.v=n}toDOM(t=qe()){return on(t,this)}}const un=new WeakMap;
/*! (c) Andrea Giammarchi - MIT */
const pn=(t=>(e,...n)=>new hn(t,e,n))(!1);function cn(t,e){const n=0===t.length?"display:block":"display:none",r=t=>e(t.target.dataset.id);return pn`
        <h3 class="center">Sauvegardes</h3>
        <div class="container-ls">
            <pre style=${n}>Pas encore de sauvegarde</pre>
            ${t.map((t=>function({id:t,text:e},n){return pn`
        <button data-id=${t} onclick=${n}>${e}</button>
    `}(t,r)))}
        </div>
        <p>
            <form class="center padding" method="dialog">
                <button class="button">Fermer</button>
            </form>
        </p>
    `}let ln=fn();function fn(){return(new Date).getTime()}function dn(t){return""===t.replace(/\s/g,"")}function vn(t,e){return!dn(t)&&t!==e&&(localStorage.setItem(ln,JSON.stringify({code:t,time:ln})),!0)}function xn(t){const e=new Date(t);return new Intl.DateTimeFormat("fr-FR",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}).format(e)}function yn(){input.value=oe;const t=function(t,e){const{width:n,height:r}=t.getBoundingClientRect(),s=ie(e),i=s.map((()=>document.createElement("canvas")));for(const e of i)e.width=n,e.height=r,e.setAttribute("style",ae),t.prepend(e);return{getContext:t=>i[t].getContext("2d"),getAll(){return s.map((t=>({ctx:this.getContext(t),clear:()=>this.clear(t)})))},getCanvas:t=>i[t].getContext("2d"),getDimension:()=>({width:n,height:r}),clear(t){this.getContext(t).clearRect(0,0,n,r)},clearAll(){for(const t of s)this.clear(t)},layerNum:e}}(cLayers,2);let e=!1;function n(t){input.value=function(t){const e=localStorage.getItem(t);if(!e)throw"ERROR malformed local storage";const{code:n,time:r}=JSON.parse(e);return ln=r,n}(t),r()}function r(){if(e)return;e=!0,textError.innerText="",t.clearAll();const{error:n}=function(t,e){try{const{commands:n,error:r}=function(t){const e=[];let n=!1;try{const n=t.split("\n"),r=[];let s={drawing:!0,color:"black"};for(const[t,i]of n.entries())""!==i&&(s=Yt(i,t,r,e,s))}catch(t){n=t}return{commands:e,error:n}}(e);return r?{error:r}:(te({layers:t,commands:n}),{error:null})}catch(t){return console.log(t),{error:t}}}(t,input.value);e=!1,n&&(textError.innerText=n)}r(),input.addEventListener("keyup",(()=>{vn(input.value,oe),r()})),btn_info.addEventListener("click",(()=>{dialog.showModal()})),btn_list.addEventListener("click",(()=>{((t,e)=>{const n=un.get(t)||fe(un,t,qe()),{b:r}=n;r!==("function"==typeof e?e():e).toDOM(n)&&t.replaceChildren(n.b.valueOf())})(dialog_list,cn(function(){let t=[];for(const[e,n]of Object.entries(localStorage)){const{code:e,time:r}=JSON.parse(n),s=xn(r);t.push({id:r,text:s})}return t}(),n)),dialog_list.showModal()})),btn_new.addEventListener("click",(()=>{var e;dn(e=input.value)||vn(e),ln=fn(),input.value="",t.clearAll()}))}yn();export{yn as run};
